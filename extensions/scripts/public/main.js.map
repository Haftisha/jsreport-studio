{"version":3,"sources":["webpack:///webpack/bootstrap d8576124d83b00c24e97","webpack:///./main_dev.js","webpack:///./ScriptEditor.js","webpack:///external \"Studio.runtime['core-js/object/assign']\"","webpack:///external \"Studio.runtime['core-js/object/get-prototype-of']\"","webpack:///external \"Studio.runtime['helpers/classCallCheck']\"","webpack:///external \"Studio.runtime['helpers/createClass']\"","webpack:///external \"Studio.runtime['helpers/possibleConstructorReturn']\"","webpack:///external \"Studio.runtime['helpers/inherits']\"","webpack:///external \"Studio.libraries['react']\"","webpack:///external \"Studio\"","webpack:///./ScriptProperties.js","webpack:///external \"Studio.runtime['helpers/extends']\"","webpack:///external \"Studio.runtime['core-js/object/keys']\""],"names":[],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap d8576124d83b00c24e97\n **/","import ScriptEditor from './ScriptEditor.js'\r\nimport Properties from './ScriptProperties.js'\r\nimport Studio from 'jsreport-studio'\r\n\r\nStudio.addEntitySet({ name: 'scripts', faIcon: 'fa-cogs', visibleName: 'script' })\r\nStudio.addPropertiesComponent(Properties.title, Properties, (entity) => entity.__entitySet === 'templates')\r\nStudio.addEditorComponent('scripts', ScriptEditor)\r\n\r\nStudio.previewListeners.push((request, entities) => {\r\n  if (!request.template.scripts) {\r\n    return\r\n  }\r\n\r\n  request.template.scripts = request.template.scripts.map((s) => {\r\n    const script = Studio.getEntityByShortid(s.shortid, false)\r\n\r\n    if (!script) {\r\n      return s\r\n    }\r\n\r\n    return script\r\n  }).filter((s) => !s.__isNew || s.content)\r\n})\n\n\n/** WEBPACK FOOTER **\n ** ./main_dev.js\n **/","import React, { Component } from 'react'\r\nimport { TextEditor } from 'jsreport-studio'\r\n\r\nexport default class ScriptEditor extends Component {\r\n  static propTypes = {\r\n    entity: React.PropTypes.object.isRequired,\r\n    onUpdate: React.PropTypes.func.isRequired\r\n  }\r\n\r\n  render () {\r\n    const { entity, onUpdate } = this.props\r\n\r\n    return (<TextEditor\r\n      name={entity._id}\r\n      mode='javascript'\r\n      value={entity.content}\r\n      onUpdate={(v) => onUpdate(Object.assign({}, entity, {content: v}))}\r\n      />)\r\n  }\r\n}\r\n\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./ScriptEditor.js\n **/","module.exports = Studio.runtime['core-js/object/assign'];\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"Studio.runtime['core-js/object/assign']\"\n ** module id = 2\n ** module chunks = 0\n **/","module.exports = Studio.runtime['core-js/object/get-prototype-of'];\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"Studio.runtime['core-js/object/get-prototype-of']\"\n ** module id = 3\n ** module chunks = 0\n **/","module.exports = Studio.runtime['helpers/classCallCheck'];\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"Studio.runtime['helpers/classCallCheck']\"\n ** module id = 4\n ** module chunks = 0\n **/","module.exports = Studio.runtime['helpers/createClass'];\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"Studio.runtime['helpers/createClass']\"\n ** module id = 5\n ** module chunks = 0\n **/","module.exports = Studio.runtime['helpers/possibleConstructorReturn'];\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"Studio.runtime['helpers/possibleConstructorReturn']\"\n ** module id = 6\n ** module chunks = 0\n **/","module.exports = Studio.runtime['helpers/inherits'];\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"Studio.runtime['helpers/inherits']\"\n ** module id = 7\n ** module chunks = 0\n **/","module.exports = Studio.libraries['react'];\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"Studio.libraries['react']\"\n ** module id = 8\n ** module chunks = 0\n **/","module.exports = Studio;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"Studio\"\n ** module id = 9\n ** module chunks = 0\n **/","import React, { Component } from 'react'\r\n\r\nexport default class ScriptProperties extends Component {\r\n  selectScripts (entities) {\r\n    return Object.keys(entities).filter((k) => entities[k].__entitySet === 'scripts').map((k) => entities[k])\r\n  }\r\n\r\n  static getSelectedScripts (entity, entities) {\r\n    const getName = (s) => {\r\n      const foundScripts = Object.keys(entities).map((k) => entities[k]).filter((sc) => sc.shortid === s.shortid)\r\n\r\n      return foundScripts.length ? foundScripts[0].name : ''\r\n    }\r\n\r\n    return (entity.scripts || []).map((s) => ({\r\n      ...s,\r\n      name: getName(s)\r\n    }))\r\n  }\r\n\r\n  renderOrder () {\r\n    const scripts = ScriptProperties.getSelectedScripts(this.props.entity, this.props.entities)\r\n\r\n    return <span>{scripts.map((s) => <span key={s.shortid}>{s.name + ' '}</span>)}</span>\r\n  }\r\n\r\n  componentDidMount () {\r\n    this.removeInvalidScriptReferences()\r\n  }\r\n\r\n  componentDidUpdate () {\r\n    this.removeInvalidScriptReferences()\r\n  }\r\n\r\n  static title (entity, entities) {\r\n    if (!entity.scripts || !entity.scripts.length) {\r\n      return 'scripts'\r\n    }\r\n\r\n    return 'scripts: ' + ScriptProperties.getSelectedScripts(entity, entities).map((s) => s.name).join(', ')\r\n  }\r\n\r\n  removeInvalidScriptReferences () {\r\n    const { entity, entities, onChange } = this.props\r\n\r\n    if (!entity.scripts) {\r\n      return\r\n    }\r\n\r\n    const updatedScripts = entity.scripts.filter((s) => Object.keys(entities).filter((k) => entities[k].__entitySet === 'scripts' && entities[k].shortid === s.shortid).length)\r\n\r\n    if (updatedScripts.length !== entity.scripts.length) {\r\n      onChange({ _id: entity._id, scripts: updatedScripts })\r\n    }\r\n  }\r\n\r\n  render () {\r\n    const { entity, entities, onChange } = this.props\r\n    const scripts = this.selectScripts(entities)\r\n\r\n    const selectValues = (event, ascripts) => {\r\n      const el = event.target\r\n      let scripts = Object.assign([], ascripts)\r\n\r\n      for (var i = 0; i < el.options.length; i++) {\r\n        if (el.options[i].selected) {\r\n          if (!scripts.filter((s) => s.shortid === el.options[i].value).length) {\r\n            scripts.push({ shortid: el.options[i].value })\r\n          }\r\n        } else {\r\n          if (scripts.filter((s) => s.shortid === el.options[i].value).length) {\r\n            scripts = scripts.filter((s) => s.shortid !== el.options[i].value)\r\n          }\r\n        }\r\n      }\r\n\r\n      return scripts\r\n    }\r\n\r\n    return (\r\n      <div className='properties-section'>\r\n        <div className='form-group'>\r\n          <select title='Use CTRL to deselect item and also to select multiple options. The order of selected scripts is reflected on the server'\r\n            multiple size='7' value={entity.scripts ? entity.scripts.map((s) => s.shortid) : []}\r\n            onChange={(v) => onChange({_id: entity._id, scripts: selectValues(v, entity.scripts)})}>\r\n            {scripts.map((s) => <option key={s.shortid} value={s.shortid}>{s.name}</option>)}\r\n          </select>\r\n          {(entity.scripts && entity.scripts.length) ? <div><span>Run order:</span>{this.renderOrder()}</div> : <div/>}\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./ScriptProperties.js\n **/","module.exports = Studio.runtime['helpers/extends'];\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"Studio.runtime['helpers/extends']\"\n ** module id = 11\n ** module chunks = 0\n **/","module.exports = Studio.runtime['core-js/object/keys'];\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"Studio.runtime['core-js/object/keys']\"\n ** module id = 12\n ** module chunks = 0\n **/"],"sourceRoot":""}